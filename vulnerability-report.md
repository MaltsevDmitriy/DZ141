Vulnerability Report
Reviewer 1: Ben Shields

Reviewer 2: Conor Clary

Date: Feb 5, 2016

Reviewing nVisium Task Manager


**A1 - Injection:**
Exposure

Repair

**A2 - Broken Auth:**
Exposure

Repair

**A3 - XSS:**
Exposure

Repair

**A4 - Insecure DOR:**

Exposure:
Many instances of Insecure Direct Object References. You can navigate to functions that should really be protected accessing a variety of routes.

/taskManager/profile/profile_id : access and edit existing user profiles, including admin (id=1)

/taskManager/downloadprofilepic/profile_id : view profile pictures

/taskManager/dashboard/ : access and edit any project and/or task

/taskManager/project_id/upload/ : access a project and upload a file

/taskManager/project_id/task_id : access projects and edit them

/taskManager/project_id/task_edit/task_id : access specific tasks and edit them

Repair:

This is an example repair for the upload file to project view.

```python
def upload(request, project_id):

    if request.method == 'POST':

        user = request.user

        if user.is_authenticated():

            etc.
```

The user must be authenticated to successfully post. However, the user can still navigate to this page by url.

**A5 - Security Misconfiguration:**

Exposure:
Security Misconfiguration can occur when development aspects of the application remain in production levels. Debug being left set to True in a production level application is an example of Security Misconfiguration.

Repair:
In settings.py:

```python
DEBUG = False
TEMPLATE_DEBUG = False

ALLOWED_HOSTS = ['127.0.0.1:8000']
```

**A6 - Sensitive Data Exposure:**

Exposure:
Sensitive data include passwords, addresses, phone numbers, social security numbers, credit card numbers, etc. Often, sensitive data is exposed in transit if it is not properly encrypted. MD5 is not a very strong hashing algorithm: https://en.wikipedia.org/wiki/MD5.

Repair:
django.contrib.auth.hashers.py has a bunch of other hashing algorithms available.

in settings.py:

```python
PASSWORD_HASHERS = ['django.contrib.auth.hashers.PBKDF2PasswordHasher']
```

**A7 - Missing Function Level Access Control:**

Exposure:
In manage_groups view, a check is performed for authentication ie to see if the user is logged in correctly. However, access is never checked for authorization. Does the user have the right permissions to perform this action?

Repair:
Make sure to authorize in addition to authenticating.

```python
def manage_groups(request):

    user = request.user

    if user.is_authenticated():

        user_list = User.objects.order_by('date_joined')

        if request.method == 'POST' and user.has_perm('can_change_group'):
            etc.

```

**A4 - Cross-Site Request Forgery:**

Exposure

Repair

```python

```