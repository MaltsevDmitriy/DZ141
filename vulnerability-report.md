# Vulnerabilities Report

Reviewer 1: Justin Lange

## Reviewing nVisium Task Manager

### XSS

#### Exposure
The site is vulnerable to cross-site scripting. By changing the
username, I was able to inject arbitrary HTML (and, through the
<script> tag, JS) into the page I was viewing. To test this, I set my
username to <script>alert('woops!')</script> and noticed that whenever
I refreshed the page, a dialog with "woops!" in it appeared.

#### Repair
In base_backend.html on line 58, the template marks user.username as
safe. By removing this, the problem is fixed. A number of other parts
of templates are innapropriately marked as safe, such as in
search.html, task.html, etc. For example, `{{ username|safe }}` should
simply be `{{ username }}`. The safe modifier should only be used when
one is absolutely sure the HTML being inserted is safe (e.g., if it
does not originate from user input at all).


### Insecure DOR

#### Exposure
By visiting `/taskManager/dashboard/` when one is logged out, all of the
tasks may be viewed. Furthermore, one can visit any of the tasks
regardless of authentication. (e.g.,
`http://127.0.0.1:8000/taskManager/2/12/`).

#### Repair
Whenever a user requests a page created by another user, the
authentication status of the user should be checked. This site is
insecure both in allowing logged out users to see all tasks, and in
allowing users to see each other's tasks. `/taskManager/dashboard/`
should be decorated with `login_required` in Django, and additionally
any tasks should check that the task is owned by the user. For
example, in views.py, @login_required should be added above line 629
to prevent the issue of seeing anyone's tasks when logged out.
