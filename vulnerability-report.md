**Reviewer:** Amos Boldor

**Date:** February 5, 2017

**Reviewing:** nVisium Task Manager


----------------------

**Vulnerability 1: SQL Injection**

**Exposure:**

When uploading a file to a project you can pass in sql commands and it will execute of done right because they uplaod a file using raw sql

Views.py contained the problem.  You are able to repair the file by using the object relational manager to properly escape user input:

**Repair:**
```python
file_upload = File(name=name, path=upload_path, project=proj)
file_upload.save()
```

----------------------
**Vulnerability 2: Broken Authentication**

**Exposure:**

You can manually give a user superuser status on registration. The was because of an incomplete list of excluded user attributes. 

**Repair:**

Forms.py contained the issue. I replaced the exclude value with a fields value, specifically listing the permitted form inputs. 
```python
fields = ('username', 'first_name', 'last_name', 'email', 'password')
```

----------------------
**Vulnerability 3:** Cross-Site Scripting (XSS)

**Exposure:**

Code review exposed that several templates accessed the user’s username with the safe method. This allowed to execute the username as code.

**Repair**

taskManager/base_backend.html and tutorials/base.html contained the vulnerable code. I removed the reference to the safe method.
Django can automatically add a header to configure clients browsers XSS protection to always block XSS attacks it detects. To do this set SECURE_BROWSER_XSS_FILTER to True
```python
{{ user.username|safe }}
to
{{ user.username }}
```
and
```python
SECURE_BROWSER_XSS_FILTER = True
```

----------------------
**Vulnerability 4:** Insecure Direct Object Reference

**Exposure:**

I found many instances of Insecure DOR. 
By navigating to **/taskManager/profile/_profile_number_** I was able to access and edit any existing user’s profile.
By navigating to **/_project_id_/upload** I was able to upload any file I chose to a project.
By navigating to **/downloadprofilepic/_user_id** I was able to access any users’ profile pic.
You can also **view and edit any task, create new tasks, delete tasks, create and edit projects, view project details, create project notes and edit them**.

**Repair**
Added @permission_required decorator the relevant view functions.
All in views.py

----------------------
**Vulnerability 5:** Security Misconfiguration

**Exposure:**

The debug varaible is set to True
If this is set to true than your app is already hacked.

**Repair**

Set debug to false

```python
DEBUG = False
```

----------------------
**Vulnerability 6:** Sensitive Data Exposure

**Exposure:**

Although the app is encrpting the users passwords MD5 hashing is useless cause it broken now.
So if a hacker gets into the database while all the passwords are md5 hashed then he or she can break them easily.

**Repair**

Use hashing algorithm like SHA1 or better.
Set PASSWORD_HASHERS to django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher.

```python
PASSWORD_HASHERS = ['django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher']
```
